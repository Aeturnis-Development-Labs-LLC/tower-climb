# Contract P0-S1-C1: Window Creation

## Metadata
- **Contract ID**: P0-S1-C1
- **System**: Window and Display
- **Priority**: Critical
- **Estimated Time**: 30-45 minutes
- **Dependencies**: None
- **Version**: 1.0.0

## Description
Create a Pygame window with proper initialization, title, and icon. The window should be 800x600, centered on screen, and handle basic window events (close).

## UTF Test Blocks

### UTF-Block-P0-S1-C1-T1: Window Initialization
```python
# Test: Window creates successfully with correct properties
def test_window_initialization():
    """
    Given: Pygame is available
    When: create_window() is called
    Then: 
      - Window appears with size 800x600
      - Window title is "Tower Climb"
      - Window is centered on screen
      - pygame.display.get_surface() is not None
    """
    # Error-Tags: ['PYGAME_INIT_FAILED', 'DISPLAY_MODE_UNSUPPORTED']
```

### UTF-Block-P0-S1-C1-T2: Window Close Event
```python
# Test: Window handles close button properly
def test_window_close_event():
    """
    Given: Window is created and running
    When: User clicks the X button or presses Alt+F4
    Then:
      - QUIT event is detected
      - Game loop exits cleanly
      - Pygame quits properly
      - No errors or crashes
    """
    # Error-Tags: ['EVENT_HANDLER_MISSING', 'CLEANUP_FAILED']
```

### UTF-Block-P0-S1-C1-T3: Window Properties
```python
# Test: Window has correct properties set
def test_window_properties():
    """
    Given: Window is created
    When: Properties are queried
    Then:
      - Window width == 800
      - Window height == 600
      - Window is not fullscreen
      - Window is resizable == False (MVP)
      - FPS target == 60
    """
    # Error-Tags: ['INVALID_WINDOW_SIZE', 'PROPERTY_MISMATCH']
```

## Implementation Requirements

### Core Components
```python
# window.py
class Window:
    def __init__(self, width: int = 800, height: int = 600, title: str = "Tower Climb"):
        """Initialize game window."""
        
    def handle_events(self) -> bool:
        """Process window events. Returns False if should quit."""
        
    def clear(self) -> None:
        """Clear the screen for next frame."""
        
    def present(self) -> None:
        """Present the drawn frame to screen."""
```

### Error Tags
- `PYGAME_INIT_FAILED`: Pygame initialization failed
- `DISPLAY_MODE_UNSUPPORTED`: Requested display mode not available
- `EVENT_HANDLER_MISSING`: No handler for required event type
- `CLEANUP_FAILED`: Error during shutdown sequence
- `INVALID_WINDOW_SIZE`: Window dimensions invalid
- `PROPERTY_MISMATCH`: Window property doesn't match specification

## DDERF Strategies

### PYGAME_INIT_FAILED
1. **Detect**: pygame.init() returns error tuple
2. **Diagnose**: Check error message, likely missing SDL libraries
3. **Explain**: "Pygame initialization failed - check installation"
4. **Resolve**: Try individual module init, fallback to software renderer
5. **Fix**: Document minimum requirements, add pre-flight checks

### DISPLAY_MODE_UNSUPPORTED
1. **Detect**: pygame.display.set_mode() raises exception
2. **Diagnose**: Requested resolution may exceed screen size
3. **Explain**: "Cannot create window with requested settings"
4. **Resolve**: Try smaller resolution, windowed mode
5. **Fix**: Query available modes first, pick best fit

## Security Considerations
- Window title must be sanitized (no user input initially)
- Prevent window from being created off-screen
- No external resource loading in this contract

## Acceptance Criteria
- [ ] Window appears on screen
- [ ] Window has correct size (800x600)
- [ ] Window title shows "Tower Climb"
- [ ] Close button works properly
- [ ] No memory leaks on quit
- [ ] All UTF tests pass
- [ ] Coverage â‰¥95%