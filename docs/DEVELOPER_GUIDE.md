# Developer Guide - Tower Climb

## Quick Start

### 1. Clone and Setup
```bash
git clone https://github.com/Aeturnis-Development-Labs-LLC/tower-climb.git
cd tower-climb
python scripts/setup_dev.py
```

### 2. Activate Environment
```bash
# Windows
venv\Scripts\activate

# Linux/Mac (future)
source venv/bin/activate
```

### 3. Run the Game
```bash
python -m tower_climb
```

## Development Workflow

### Daily Development
1. **Pull latest changes**: `git pull`
2. **Create feature branch**: `git checkout -b feature/your-feature`
3. **Write contracts first**: See contracts/README.md
4. **Implement with TDD**: Write tests, then code
5. **Check quality**: `make quality`
6. **Commit changes**: `git add . && git commit -m "feat: description"`
7. **Push and PR**: `git push origin feature/your-feature`

### Commit Message Format
```
type: description

- feat: New feature
- fix: Bug fix
- docs: Documentation only
- style: Code style (formatting, etc)
- refactor: Code restructuring
- test: Test additions/changes
- chore: Build process, tools
```

### Code Quality Commands
```bash
make format      # Auto-format code
make lint        # Check code style
make typecheck   # Check type hints
make test        # Run all tests
make coverage    # Test with coverage report
make quality     # Run all checks
```

## Project Structure

```
tower-climb/
├── contracts/           # UTF behavioral contracts
│   └── phase-0/        # Phase-specific contracts
├── src/tower_climb/    # Main source code
│   ├── core/           # Core game systems
│   ├── systems/        # ECS systems
│   ├── world/          # World generation
│   └── ui/             # User interface
├── tests/              # Test suite
├── docs/               # Documentation
└── scripts/            # Development tools
```

## Testing Strategy

### Test Categories
1. **Unit Tests**: Individual components
2. **Integration Tests**: System interactions
3. **Contract Tests**: UTF validation

### Running Tests
```bash
# All tests
pytest

# Specific test file
pytest tests/test_player.py

# With coverage
pytest --cov=src --cov-report=html

# Watch mode (install pytest-watch)
ptw
```

### Writing Tests
```python
# AI-Generated by CAFE v5.1-ACG - MIT License
"""Test example following CAFE standards."""

import pytest
from tower_climb.core.player import Player


class TestPlayer:
    """Tests for Player entity."""
    
    def test_player_creation(self):
        """Test player initializes with correct defaults."""
        player = Player()
        assert player.health == 100
        assert player.position == (400, 300)
    
    def test_player_movement(self):
        """Test player moves correctly."""
        player = Player()
        player.move(10, 0)  # Move right
        assert player.position == (410, 300)
```

## Debugging Tips

### Visual Debug Mode
```python
# Enable debug rendering
DEBUG_RENDER = True  # Shows hitboxes, coordinates

# Debug print statements
if DEBUG:
    print(f"Player pos: {player.position}")
```

### Common Issues

1. **Import Errors**
   - Ensure you're in venv: `pip list`
   - Reinstall: `pip install -e .`

2. **Pygame Window Issues**
   - Check display drivers
   - Try windowed mode first

3. **Performance Problems**
   - Profile with cProfile
   - Check entity counts
   - Reduce particles/effects

## CI/CD Integration

### Before Pushing
1. Run `make quality` locally
2. Ensure 90%+ test coverage
3. Fix any type errors
4. Update documentation if needed

### GitHub Actions
- **CI runs on**: Every push and PR
- **Checks**: Format, lint, type, test, security
- **Required to pass**: Tests and coverage

### Making a Release
1. Merge all features to develop
2. Test thoroughly
3. Merge develop to main
4. Tag: `git tag v0.1.0`
5. Push: `git push --tags`
6. GitHub Actions builds release

## Code Style Guide

### General Rules
- **Line length**: 88 chars (black default)
- **Imports**: isort with black profile
- **Docstrings**: Google style
- **Type hints**: All functions

### Example Code Style
```python
# AI-Generated by CAFE v5.1-ACG - MIT License
"""Module description."""

from dataclasses import dataclass
from typing import Optional, Tuple

import pygame


@dataclass
class Entity:
    """Game entity with position and health.
    
    Attributes:
        position: (x, y) tuple in pixels
        health: Current health points
    """
    position: Tuple[float, float]
    health: int = 100
    
    def move(self, dx: float, dy: float) -> None:
        """Move entity by given delta.
        
        Args:
            dx: Horizontal movement
            dy: Vertical movement
        """
        x, y = self.position
        self.position = (x + dx, y + dy)
```

## Contributing

### Process
1. Check issues for tasks
2. Comment on issue to claim
3. Create feature branch
4. Implement with tests
5. Submit PR with description
6. Address review feedback

### Review Criteria
- [ ] Follows CAFE methodology
- [ ] Has UTF contract (if applicable)
- [ ] Tests pass with coverage
- [ ] Code is simple and clear
- [ ] Documentation updated

## Resources

- [CAFE Methodology](../Methods+/README.md)
- [Game Design](GAME_DESIGN.md)
- [Technical Architecture](TECHNICAL_ARCHITECTURE.md)
- [Visual Design](VISUAL_DESIGN.md)
- [CI/CD Strategy](CI_CD_STRATEGY.md)

## Questions?

- Check existing documentation first
- Look for similar code patterns
- Ask in GitHub issues
- Keep it simple!

Remember: **MVP first, perfect later!**